<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width,initial-scale=1">

<style>
body{
 font-family:Arial;
 background:#050010;
 color:white;
 padding:20px;
}

input,select,button{
 width:100%;
 padding:12px;
 margin:8px 0;
 border-radius:10px;
 border:none;
}

button{
 background:#a000ff;
 color:white;
 cursor:pointer;
}

.card{
 background:#140022;
 padding:10px;
 margin:10px 0;
 border-radius:12px;
}

.del{
 background:red;
}
</style>
</head>

<body>

<!-- LOGIN -->
<div id="loginBox">
<h2>Вход в админку</h2>
<input id="passInput" placeholder="Пароль">
<button id="loginBtn">Войти</button>
</div>

<!-- PANEL -->
<div id="panel" style="display:none">

<h2>Добавить товар</h2>

<input id="name" placeholder="Название">
<input id="price" placeholder="Цена">
<input id="image" placeholder="URL картинки">

<select id="category">
<option value="pod">Pod</option>
<option value="liquid">Жидкость</option>
<option value="disposable">Одноразка</option>
<option value="coil">Испаритель</option>
</select>

<button id="addBtn">Добавить</button>

<h2>Все товары</h2>
<div id="list"></div>

</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc }
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

// Firebase
const app=initializeApp({
 apiKey:"AIzaSyDJxLWeTxVeH2r64rv9rCLUW4RtM1A6zXI",
 authDomain:"vapestock-3dc76.firebaseapp.com",
 projectId:"vapestock-3dc76"
});
const db=getFirestore(app);

// LOGIN
document.getElementById("loginBtn").onclick=()=>{
 const pass=document.getElementById("passInput").value;

 if(pass==="lock123612"){
   document.getElementById("loginBox").style.display="none";
   document.getElementById("panel").style.display="block";
   load();
 } else {
   alert("Неверный пароль");
 }
};

// ADD PRODUCT
document.getElementById("addBtn").onclick=async()=>{
 const n=name.value.trim();
 const p=price.value.trim();
 const i=image.value.trim();
 const c=category.value;

 if(!n||!p||!i){
   alert("Заполни всё");
   return;
 }

 await addDoc(collection(db,"products"),{
  name:n,
  price:p,
  image:i,
  category:c
 });

 alert("Добавлено!");
 name.value="";
 price.value="";
 image.value="";

 load();
};

// LOAD PRODUCTS
async function load(){
 list.innerHTML="";
 const snap=await getDocs(collection(db,"products"));

 snap.forEach(d=>{
  const p=d.data();

  const div=document.createElement("div");
  div.className="card";
  div.innerHTML=`
    ${p.name} — ${p.price}
    <button class="del">Удалить</button>
  `;

  div.querySelector(".del").onclick=async()=>{
    await deleteDoc(doc(db,"products",d.id));
    load();
  };

  list.appendChild(div);
 });
}

</script>

</body>
</html>
