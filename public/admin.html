<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
body{background:#050010;color:white;font-family:Arial;padding:20px}
input,button,select{width:100%;padding:12px;margin:8px 0;border-radius:10px;border:none}
button{background:#a000ff;color:white}
.progress{height:6px;background:#333;border-radius:10px}
.bar{height:100%;width:0;background:#a000ff}
</style>
</head>

<body>

<h2>–ê–¥–º–∏–Ω –≤—Ö–æ–¥</h2>
<input id="pass" placeholder="–ü–∞—Ä–æ–ª—å">
<button onclick="login()">–í–æ–π—Ç–∏</button>

<div id="panel" style="display:none">

<h3>–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</h3>

<input id="name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ">
<input id="price" placeholder="–¶–µ–Ω–∞">

<input type="file" id="file" accept="image/*">

<div class="progress"><div id="bar" class="bar"></div></div>

<input id="image" placeholder="URL —Ñ–æ—Ç–æ –ø–æ—è–≤–∏—Ç—Å—è —Ç—É—Ç">

<select id="category">
<option value="pod">Pod</option>
<option value="liquid">–ñ–∏–¥–∫–æ—Å—Ç—å</option>
<option value="disposable">–û–¥–Ω–æ—Ä–∞–∑–∫–∞</option>
</select>

<button onclick="add()">–î–æ–±–∞–≤–∏—Ç—å —Ç–æ–≤–∞—Ä</button>

</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getFirestore, collection, addDoc }
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

import { getStorage, ref, uploadBytesResumable, getDownloadURL }
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-storage.js";

const app=initializeApp({
 apiKey:"AIzaSyDJxLWeTxVeH2r64rv9rCLUW4RtM1A6zXI",
 authDomain:"vapestock-3dc76.firebaseapp.com",
 projectId:"vapestock-3dc76",
 storageBucket:"vapestock-3dc76.firebasestorage.app"
});

const db=getFirestore(app);
const storage=getStorage(app);

window.login=()=>{
 if(pass.value==="lock123612"){
   panel.style.display="block";
 }
};

// üì∏ –ó–ê–ì–†–£–ó–ö–ê –§–û–¢–û
file.onchange=()=>{
 const f=file.files[0];
 if(!f) return;

 const r=ref(storage,"products/"+Date.now()+"_"+f.name);
 const task=uploadBytesResumable(r,f);

 task.on("state_changed",s=>{
   bar.style.width=(s.bytesTransferred/s.totalBytes*100)+"%";
 },
 console.error,
 async()=>{
   const url=await getDownloadURL(task.snapshot.ref);
   image.value=url;
   alert("–§–æ—Ç–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ!");
 });
};

// ‚ûï –î–û–ë–ê–í–õ–ï–ù–ò–ï
window.add=async()=>{
 if(!name.value||!price.value||!image.value){
   alert("–ó–∞–ø–æ–ª–Ω–∏ –≤—Å—ë!");
   return;
 }

 await addDoc(collection(db,"products"),{
  name:name.value,
  price:price.value,
  image:image.value,
  category:category.value,
  views:0
 });

 alert("–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω!");
};

</script>
</body>
</html>
