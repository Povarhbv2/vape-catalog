<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
body{background:#050010;color:white;font-family:Arial;padding:20px}
input,button,select{width:100%;padding:12px;margin:8px 0;border-radius:10px;border:none}
button{background:#a000ff;color:white}
.progress{height:6px;background:#333;border-radius:10px}
.bar{height:100%;width:0;background:#a000ff}
</style>
</head>

<body>

<h2>Админ вход</h2>
<input id="pass">
<button onclick="login()">Войти</button>

<div id="panel" style="display:none">

<h3>Добавить товар</h3>

<input id="name" placeholder="Название">
<input id="price" placeholder="Цена">

<input type="file" id="file" accept="image/*">

<div class="progress"><div id="bar" class="bar"></div></div>

<input id="image" placeholder="URL появится тут">

<select id="category">
<option value="pod">Pod</option>
<option value="liquid">Жидкость</option>
<option value="disposable">Одноразка</option>
</select>

<button onclick="add()">Добавить товар</button>

</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getFirestore, collection, addDoc }
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

import { getStorage, ref, uploadBytes, getDownloadURL }
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-storage.js";

const app=initializeApp({
 apiKey:"AIzaSyDJxLWeTxVeH2r64rv9rCLUW4RtM1A6zXI",
 authDomain:"vapestock-3dc76.firebaseapp.com",
 projectId:"vapestock-3dc76",
 storageBucket:"vapestock-3dc76.appspot.com" // ← ВАЖНО!
});

const db=getFirestore(app);
const storage=getStorage(app);

window.login=()=>{
 if(pass.value==="lock123612"){
   panel.style.display="block";
 }
};

file.onchange=async()=>{
 const f=file.files[0];
 if(!f) return;

 const r=ref(storage,"products/"+Date.now()+"_"+f.name);

 await uploadBytes(r,f);

 const url=await getDownloadURL(r);
 image.value=url;

 alert("Фото загружено!");
};

window.add=async()=>{
 if(!name.value||!price.value||!image.value){
   alert("Заполни всё!");
   return;
 }

 await addDoc(collection(db,"products"),{
  name:name.value,
  price:price.value,
  image:image.value,
  category:category.value
 });

 alert("Товар добавлен!");
};

</script>
</body>
</html>
