<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width,initial-scale=1">
<script src="https://telegram.org/js/telegram-web-app.js"></script>

<style>
body{
 margin:0;
 font-family:Arial;
 background:#070012;
 color:#e0b3ff;
}

.search{padding:10px}
.search input{
 width:100%;padding:12px;
 border-radius:12px;border:none;
 background:#140022;color:white;
}

.catbar{
 display:flex;gap:8px;
 overflow:auto;padding:10px;
}
.cat{
 background:#140022;
 border:1px solid #a000ff;
 padding:8px 14px;
 border-radius:20px;
}

.card{
 background:#0f001a;
 margin:15px;
 padding:12px;
 border-radius:16px;
 box-shadow:0 0 20px #8000ff55;
}
.card img{
 width:100%;
 border-radius:12px;
}
</style>
</head>

<body>

<div class="search">
<input id="search" placeholder="Поиск..." oninput="load()">
</div>

<div class="catbar" id="catbar"></div>
<div id="catalog"></div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import { getFirestore, collection, getDocs }
from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

const app=initializeApp({
 apiKey:"AIzaSyDJxLWeTxVeH2r64rv9rCLUW4RtM1A6zXI",
 authDomain:"vapestock-3dc76.firebaseapp.com",
 projectId:"vapestock-3dc76"
});
const db=getFirestore(app);

const cats={
 all:"Все",
 pod:"Pod-системы",
 liquid:"Жидкости",
 disposable:"Одноразки",
 coil:"Испарители"
};

let current="all";

for(const k in cats){
 const b=document.createElement("div");
 b.className="cat";
 b.innerText=cats[k];
 b.onclick=()=>{current=k;load();}
 catbar.appendChild(b);
}

async function load(){
 catalog.innerHTML="";
 const s=search.value.toLowerCase();

 const snap=await getDocs(collection(db,"products"));
 snap.forEach(d=>{
  const p=d.data();
  if(current!="all" && p.category!=current) return;
  if(!p.name.toLowerCase().includes(s)) return;

  catalog.innerHTML+=`
   <div class="card">
    <img src="${p.image}">
    <h3>${p.name}</h3>
    <p>${p.price}</p>
   </div>
  `;
 });
}

load();

</script>
</body>
</html>
