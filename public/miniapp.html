<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>VapeStock</title>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDJxLWeTxVeH2r64rv9rCLUW4RtM1A6zXI",
  authDomain: "vapestock-3dc76.firebaseapp.com",
  projectId: "vapestock-3dc76",
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

window.db = db;
window.addDoc = addDoc;
window.collection = collection;
window.getDocs = getDocs;
</script>

<style>
body{
  background:#0a0014;
  color:white;
  font-family:sans-serif;
  margin:0;
}

.header{
  background:linear-gradient(45deg,#7a00ff,#ff00aa);
  padding:20px;
  text-align:center;
  font-size:28px;
}

#adminBtn{
  position:fixed;
  right:10px;
  top:10px;
  background:#ff00aa;
  border:none;
  color:white;
  padding:8px 12px;
  border-radius:8px;
}

.card{
  background:#160028;
  margin:15px;
  padding:15px;
  border-radius:12px;
}

img{
  width:100%;
  border-radius:12px;
}

input,select{
  width:100%;
  padding:10px;
  margin:5px 0;
  border-radius:8px;
  border:none;
}

button{
  padding:12px;
  border:none;
  border-radius:10px;
  background:#a000ff;
  color:white;
  width:100%;
  font-size:16px;
}

#adminPanel{
  display:none;
  position:fixed;
  inset:0;
  background:#000000ee;
  padding:20px;
  overflow:auto;
}
</style>
</head>

<body>

<div class="header">VapeStock</div>

<button id="adminBtn">⚙️</button>

<div id="products"></div>

<!-- АДМИНКА -->
<div id="adminPanel">
<h2>Админка</h2>

<input id="name" placeholder="Название">
<input id="price" type="number" placeholder="Цена">
<input id="image" placeholder="Ссылка на фото">
<select id="category">
<option>Pod</option>
<option>Жидкости</option>
<option>Одноразки</option>
</select>

<button onclick="addProduct()">Добавить товар</button>
<button onclick="closeAdmin()">Закрыть</button>
</div>

<script>
const ADMIN_PASS="lock123612";

document.getElementById("adminBtn").onclick=()=>{
  let p=prompt("Пароль");
  if(p===ADMIN_PASS){
    document.getElementById("adminPanel").style.display="block";
  }else{
    alert("Неверный пароль");
  }
}

function closeAdmin(){
  adminPanel.style.display="none";
}

async function addProduct(){
  const name=nameInput.value;
  const price=Number(priceInput.value);
  const image=imageInput.value;
  const category=categoryInput.value;

  if(!name||!price||!image){
    alert("Заполни всё");
    return;
  }

  await addDoc(collection(db,"products"),{
    name,
    price,
    image,
    category,
    views:0
  });

  alert("Добавлено!");
  loadProducts();
}

async function loadProducts(){
  products.innerHTML="";
  const snap=await getDocs(collection(db,"products"));
  snap.forEach(d=>{
    const p=d.data();
    products.innerHTML+=`
      <div class="card">
        <img src="${p.image}">
        <h3>${p.name}</h3>
        <p>${p.price} ₽</p>
      </div>
    `;
  });
}

loadProducts();
</script>

</body>
</html>
